(function(g){function r(a){var b=null,e=new XMLHttpRequest;e.open(a.type,a.url,!0);a.files||e.setRequestHeader("Content-type","application/json");a.cache&&e.setRequestHeader("Cache-Control","max-age=86400");e.onloadend=function(){200==e.status?b&&b(JSON.parse(e.responseText)):b&&b(null);e=null};a.files?e.send(a.data):e.send(a.data?JSON.stringify(a.data):null);this.done=function(a){b=a}}function k(a){var b=a.currentStyle||window.getComputedStyle(a);return Length.toPx(a,b.marginTop)}function p(){var a=
[],b=function(a,b){return a-b},e=function(c,d,f){var l=a.length;d=null==d?0:d;f=null==f?l-1:f;var h=d+Math.floor((f-d)/2);if(0==l)return l;if(0<b(c,a[f]))return f+1;if(0>b(c,a[d]))return d;l=b(c,a[h]);if(0==l)return h;if(0>l)return e(c,d,h-1);if(0<l)return e(c,h+1,f)};this.setCompare=function(a){a&&(b=a)};this.insert=function(b){a.splice(e(b),0,b)};this.length=function(){return a.length};this.at=function(b){return a[b]};this.grab=function(b){return a.splice(0,b)};this.data=function(){return a}}function n(a){var b=
function(){var a=window.performance||{};a.now=function(){return a.now||a.webkitNow||a.msNow||a.oNow||a.mozNow||function(){return(new Date).getTime()}}();return a.now()},e=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.msRequestAnimationFrame||a.oRequestAnimationFrame||function(d){a.setTimeout(function(){d(b())},1E3/60)}}(),c=function(){return new function(){var a=new p,b=function(c){0<a.length()&&e(b);var h,g;h=0;for(g=a.length();h<g&&!(a.at(h).timestamp>
c);++h);c=a.grab(h);h=0;for(g=c.length;h<g;++h)c[h].func.apply(null,c[h].args)};a.setCompare(function(a,b){return a.timestamp-b.timestamp});this.addTask=function(c){a.insert(c);0<a.length()&&e(b)}}}();a.async=function(a,e,l){"Function"!=classOf(a)||e&&"Array"!=classOf(e)||c.addTask({timestamp:l?b()+l:0,func:a,args:e||[]})}}function u(a){var b={};a.events={listen:function(a,c){var d=b[a]||[];d[d.length]=c;b[a]=d},remove:function(a,c){var d=b[a]||[],f=d.indexOf(c);0<=f&&d.splice(f,1)},emit:function(e,
c){var d=b[e];if(d)for(var f=0;f<d.length;++f)a.async(d[f],c)}}}g.hashCode=function(a){var b=0,e,c,d;if(0===a.length)return b;e=0;for(d=a.length;e<d;e++)c=a.charCodeAt(e),b=(b<<5)-b+c,b|=0;return b};g.MSInputObject=function(a){var b=this;b.__get_value=null;b.__set_value=null;a=a||{};if(window.admin||a.user){if(a.multiline){b.el=document.createElement("textarea");var e=b.el.offsetHeight-b.el.clientHeight,c=0,d=b.el.clientHeight,f=function(){async(function(){var a=b.el.value.length;a<c&&(b.el.style.height=
"auto");var f=b.el.scrollHeight+e;0<f&&(b.el.style.height=f+"px");c=a;f!=d&&(d=f)})};b.__get_value=function(){return b.el.value};b.__set_value=function(a){b.el.value=a;f()};b.el.addEventListener("keydown",f);b.el.addEventListener("keyup",f)}else b.el=document.createElement("input"),b.el.setAttribute("type","text"),b.__get_value=function(){return b.el.value},b.__set_value=function(a){b.el.value=a};b.el.onchange=function(){if(b.onchange)b.onchange(b)};a.placeholder&&this.el.setAttribute("placeholder",
a.placeholder)}else b.el=document.createElement("div"),b.__get_value=function(){return b.el.innerHTML},b.__set_value=function(a){b.el.innerHTML=a};a.className&&(b.el.className=a.className);a.id&&(b.el.id=a.id)};MSInputObject.prototype.value=function(){return this.__get_value()||""};MSInputObject.prototype.setValue=function(a){this.__set_value(a||"")};g.MSDivObject=function(a){this.el=a||document.createElement("div")};MSDivObject.prototype.addClass=function(a){-1==this.el.className.indexOf(a)&&(this.el.className=
this.el.className.concat(" ",a))};MSDivObject.prototype.removeClass=function(a){-1<this.el.className.indexOf(a)&&(this.el.className=this.el.className.replace(a,"").replace("  "," ").trim())};MSDivObject.prototype.setPlaceholder=function(a){if(window.admin){var b=this,e=document.createElement("span"),c=!0;b.has_placeholder=!0;e.className="placeholder";e.innerHTML=a;0==b.el.innerHTML.length&&(b.el.appendChild(e),b.addClass("placeholder-visible"));b.el.addEventListener("text-changed",function(){0==b.el.innerHTML.length?
(c||(b.addClass("placeholder-visible"),c=!0),b.el.appendChild(e)):c&&(c=!1,b.removeClass("placeholder-visible"))});b.el.addEventListener("focus",function(){c&&(b.el.removeChild(e),b.removeClass("placeholder-visible"),c=!1)});b.el.addEventListener("blur",function(){0==b.innerHTML.length&&(b.el.appendChild(e),b.addClass("placeholder-visible"),c=!0)});b.has_text=function(){return!c}}};MSDivObject.prototype.refresh=function(){(this.has_placeholder||this.track_change)&&this.el.dispatchEvent(new Event("text-changed"))};
MSDivObject.prototype.setText=function(a){a&&(this.el.innerHTML=a,(this.has_placeholder||this.track_change)&&this.el.dispatchEvent(new Event("text-changed")))};MSDivObject.prototype.getText=function(){return this.has_placeholder?this.has_text()?this.el.innerHTML:"":this.el.innerHTML};MSDivObject.prototype.textEdit=function(a){if(window.admin){var b=this;a=a||{};a.textItem=a.textItem||b;b.el.addEventListener("click",function(){if(!b.in_edit){b.in_edit=!0;var e=a.textItem.getText(),c=a.multiline?document.createElement("textarea"):
document.createElement("input");a.multiline&&a.autosize&&c.addEventListener("keydown",function(){async(function(){c&&(c.style.height=c.scrollHeight+"px")})});a.multiline||(c.type="text");c.className="inplace-text-edit";c.value=e;c.style.width=b.el.offsetWidth-(a.offsetWidth||0)+"px";c.style.height=b.el.offsetHeight-(a.offsetHeight||0)+"px";b.el.innerHTML="";b.el.appendChild(c);c.focus();c.onblur=function(){a.textItem.setText(c.value);c=null;b.in_edit=!1;a.textItem!=b&&(b.el.innerHTML="",b.el.appendChild(a.textItem.el),
b.refresh())}}})}};MSDivObject.prototype.loadImage=function(a){var b=this,e=a.url;async(function(){b.el.style.backgroundImage="url("+e+")"})};g.FileUpload=function(a){var b=this,e=document.createElement("div"),c=document.createElement("input");a=a||{multiple:!1};a.id&&(e.id=a.id);a.className&&(e.className=a.className);c.type="file";c.name="file";c.accept="image/*";c.multiple=a.multiple;e.appendChild(c);c.onchange=function(a){b.preview&&b.preview(a.target.files)};b.el=e};g.DropDown=function(a,b){function e(a,
b){if(a.manager)a.manager.setValue(b);else if(a.firstChild&&3==a.firstChild.nodeType)a.firstChild.nodeValue=b;else{var c=document.createTextNode(b);a.firstChild?a.insertBefore(c,a.firstChild):a.appendChild(c)}}function c(){var a=null,b=[];this.bind=function(c){b[b.length]=c;a&&e(c,a)};this.unbind=function(a){a=b.indexOf(a);0<=a&&b.splice(a,1)};this.setValue=function(c){if(a=c)for(c=0;c<b.length;++c)e(b[c],a)}}var d=this,f=b||document.createElement("div"),g=!a.adminOnly||window.admin,h=g?document.createElement("img"):
null,m=g?document.createElement("lu"):null,k=!1,r=!1,n={},t=null,q=!1,p=function(a){var b=n[a];b&&(t&&t.unbind(f),f.setAttribute("current-data-id",a),t=b,t.bind(f),g&&k&&d.close(),d.changed&&async(d.changed,[a]))};f.controller=d;d.addItem=function(a,b){var e=new c,d=null;n[a]=e;b&&e.setValue(a);g&&(d=document.createElement("li"),d.className="dropdown-item text-invert",d.onclick=function(){q||p(a)},m.appendChild(d),e.bind(d));t||p(a);return{controller:e,item:d}};d.addVirtual=function(){var a=document.createElement("li");
a.className="dropdown-item virtual text-invert";m.appendChild(a);return a};d.removeVirtual=function(a){m.contains(a)&&m.removeChild(a)};f.className=a.className?0<f.className.length?f.className+(" dropdown-container no-select text "+a.className):"dropdown-container no-select text "+a.className:0<f.className.length?f.className+" dropdown-container text":"dropdown-container text";g&&(h.src=a.src||"../images/down.png",f.appendChild(h),m.className="dropdown-list no-select",f.appendChild(m),f.onclick=function(){q||
r||(d.beforeOpen&&d.beforeOpen(),k=!0,m.style.display="block")},f.onmouseleave=function(){q||d.close()});d.el=f;d.manual=function(){q=!0};d.auto=function(){q=!1};d.open=function(){q&&(k=!0,m.style.display="block")};d.close=function(){k&&(d.beforeClose&&d.beforeClose(),m.style.right="-200%",async(function(){m.removeAttribute("style")}))};d.setText=function(a){e(f,a)};d.text=function(){return f.firstChild&&3==f.firstChild.nodeType?f.firstChild.nodeValue:""};d.value=function(){return f.getAttribute("current-data-id")};
d.setValue=function(a){p(a)};d.lock=function(){r=!0;f.setAttribute("locked",!0)};d.unlock=function(){r=!1;f.removeAttribute("locked")}};g.classOf=function(a){return/\[object (\w+)\]/.exec(Object.prototype.toString.call(a))[1]};g.getHeight=function(a){var b;document.all?(b=parseInt(a.currentStyle.height),a=parseInt(a.currentStyle.marginTop,10)+parseInt(a.currentStyle.marginBottom,10)):(b=parseInt(document.defaultView.getComputedStyle(a,"").getPropertyValue("height")),a=parseInt(document.defaultView.getComputedStyle(a,
"").getPropertyValue("margin-top"))+parseInt(document.defaultView.getComputedStyle(a,"").getPropertyValue("margin-bottom")));return b+a};g.browser={opera:!!window.opera||0<=navigator.userAgent.indexOf(" OPR/"),firefox:"undefined"!==typeof InstallTrigger,safari:0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor"),ie:!!document.documentMode};g.browser.chrome=!!window.chrome&&!window.browser.opera;g.ajax=function(a){return new r(a)};g.scrollBodyTo=function(a){var b=document.getElementById("content-wrapper"),
e=parseInt(a.offsetTop-k(a)),c=parseInt(b.scrollTop);for(a=a.parentNode;a&&a!=b;)e+=parseInt(a.offsetTop-k(a)),a=a.parentNode;if(c!=e){var d=e-c;console.log(e,c,d);morpheus.tween(500,function(a){a=c+d*a;0<=a&&a<=b.scrollHeight&&(b.scrollTop=a)})}};g.addEventListener("load",function(){new n(g);new u(g)})})(this);(function(){function g(){var g=document.getElementById("username_input"),k=document.getElementById("password_input"),p=document.getElementById("login"),n=function(){var a=4<g.value.length&&6<k.value.length;p.style.display=a?"block":"none";return a},u=function(){window.ajax({type:"POST",data:{username:g.value,password:k.value},url:"/async/user/login"}).done(function(a){a.status?window.location.href="/":(k.value="",n(),k.focus())})};g.focus();g.onkeyup=function(){n()};k.onkeyup=function(a){n()&&13==
a.keyCode&&u()}}window.addEventListener("load",function(){"/admin"==window.location.pathname&&(window.login=new g)})})();
